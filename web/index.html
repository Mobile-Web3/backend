<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>visits test</title>
</head>
<body>
<main>
    <h1>Визиты</h1>
    <p>
        Каждый раз, когда на одну из страниц сайта с подключённой Метрикой заходит посетитель,
        серверы Метрики получают информацию об этом событии — оно называется просмотром.
        Несколько просмотров, совершённых одним пользователем,
        Метрика объединяет в один визит.
        Именно визиты являются основными данными для построения отчётов в Метрике
    </p>
    <p>
        Визит начинается с перехода на сайт из какого-либо внешнего источника.
        Это может быть ссылка на стороннем сайте, рекламное объявление, поисковая система или социальная сеть.
        Пользователи также могут попадать на ваш сайт,
        открыв закладку или напечатав URL в адресной строке браузера — такие переходы называются прямыми.
    </p>
    <p>
        Визит заканчивается, когда в течение определённого времени от посетителя не поступает новых событий — по умолчанию это 30 минут.
        Если в течение 30 минут от последнего события тот же пользователь снова перейдет на сайт из внешнего источника,
        Метрика не будет считать такое посещение новым визитом — все новые просмотры страниц будут добавлены к предыдущему визиту.
    </p>
</main>
</body>
<div hidden="hidden" id=hidden-user-id>{{ .UserID}}</div>
<script type="text/javascript">
    function initUserId() {
        if (window.location.href.includes('user_id')) {
            return
        }

        const userIdDiv = document.getElementById('hidden-user-id')
        const querySymbol = window.location.href.includes('?') ? '&' : '?'
        window.history.pushState(history.state, '', `${querySymbol}user_id=${userIdDiv.innerText}`)
    }

    initUserId()
</script>
</html>